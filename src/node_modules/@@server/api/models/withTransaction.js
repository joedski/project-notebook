const { knex } = require('@@server/api/utils/knex')

/**
 * Transaction support for this set of models.
 * @param  {trx => Promise<TReturn>} action Action to execute with a transaction.
 * @return {Promise<TReturn>} Promise on the result of a transaction.
 */
module.exports = async function withTransaction(action) {
  return await knex.transaction(async (trx) => await action(trx))
}
