const knex = require('knex')
const knexConfig = require('../../../../../knexfile')

const knexEnv = process.env.NODE_ENV || 'development'
const knexEnvConfig = (() => {
  if (!knexConfig[knexEnv]) {
    console.warn('Env for Knex Config: No NODE_ENV specified; using "development"')
    return knexConfig.development
  }
  return knexConfig[knexEnv]
})()

Object.assign(module.exports, {
  knex: knex(knexEnvConfig),
  config: knexEnvConfig,
})
